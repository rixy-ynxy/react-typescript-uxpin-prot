"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.setupWatcher = void 0;
const tslib_1 = require("tslib");
const chokidar_1 = require("chokidar");
const getConfigPath_1 = require("../args/providers/paths/getConfigPath");
const getTempDirPath_1 = require("../args/providers/paths/getTempDirPath");
const DOT_FILES = /(^|[\/\\])\../;
const NODE_MODULES = /\/node_modules\//;
function setupWatcher(programArgs, onChangeListener) {
    return tslib_1.__awaiter(this, void 0, void 0, function* () {
        return new Promise((resolve, reject) => {
            const watchOptions = {
                ignored: [
                    DOT_FILES,
                    NODE_MODULES,
                    getConfigPath_1.getConfigPath(programArgs),
                    getTempDirPath_1.getTempDirPath(programArgs),
                ],
            };
            const watcher = chokidar_1.watch(programArgs.cwd, watchOptions);
            watcher.once('ready', () => resolve());
            watcher.on('change', onChangeListener);
        });
    });
}
exports.setupWatcher = setupWatcher;
//# sourceMappingURL=setupWatcher.js.map