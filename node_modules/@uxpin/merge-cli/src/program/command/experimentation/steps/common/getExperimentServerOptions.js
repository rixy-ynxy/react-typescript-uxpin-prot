"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getExperimentServerOptions = void 0;
const tslib_1 = require("tslib");
const getNgrokSessionId_1 = require("../../../../../common/services/ngrok/getNgrokSessionId");
const getLibraryBundleFilePath_1 = require("../../../../../steps/building/library/getLibraryBundleFilePath");
const getEPIDFilePath_1 = require("../../../../../steps/experimentation/epid/getEPIDFilePath");
const getProjectEPID_1 = require("../../../../../steps/experimentation/epid/getProjectEPID");
const getProjectMetadata_1 = require("../../../../../steps/experimentation/metadata/getProjectMetadata");
const getProjectRoot_1 = require("../../../../args/providers/paths/getProjectRoot");
const getTempDirPath_1 = require("../../../../args/providers/paths/getTempDirPath");
function getExperimentServerOptions(args, state) {
    return tslib_1.__awaiter(this, void 0, void 0, function* () {
        const { port, uxpinDomain, skipBrowser } = args;
        const uxpinDirPath = getTempDirPath_1.getTempDirPath(args);
        const projectRoot = getProjectRoot_1.getProjectRoot(args);
        const ngrokSessionId = getNgrokSessionId_1.getNgrokSessionId(state.ngrokUrl);
        const projectMetadata = yield getProjectMetadata_1.getProjectMetadata(uxpinDirPath);
        return {
            bundlePath: getLibraryBundleFilePath_1.getLibraryBundleFilePath(uxpinDirPath),
            epid: yield getProjectEPID_1.getProjectEPID(getEPIDFilePath_1.getEPIDFilePath(projectRoot)),
            ngrokSessionId,
            port,
            projectMetadata,
            projectName: projectMetadata.name,
            projectRoot,
            skipBrowser,
            uxpinDirPath,
            uxpinDomain,
        };
    });
}
exports.getExperimentServerOptions = getExperimentServerOptions;
//# sourceMappingURL=getExperimentServerOptions.js.map